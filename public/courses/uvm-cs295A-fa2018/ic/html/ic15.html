<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ic15</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="ic15.html" class="Module">ic15</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Basics-v3.html" class="Module">Basics-v3</a>

<a id="43" class="Comment">--------------</a>
<a id="58" class="Comment">-- IN CLASS --</a>
<a id="73" class="Comment">--------------</a>

<a id="89" class="Comment">-- permutation as a spec --</a>

<a id="118" class="Keyword">data</a> <a id="perm"></a><a id="123" href="ic15.html#123" class="Datatype">perm</a> <a id="128" class="Symbol">{</a><a id="129" href="ic15.html#129" class="Bound">A</a> <a id="131" class="Symbol">:</a> <a id="133" class="PrimitiveType">Set</a><a id="136" class="Symbol">}</a> <a id="138" class="Symbol">:</a> <a id="140" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="145" href="ic15.html#129" class="Bound">A</a> <a id="147" class="Symbol">→</a> <a id="149" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="154" href="ic15.html#129" class="Bound">A</a> <a id="156" class="Symbol">→</a> <a id="158" class="PrimitiveType">Set</a> <a id="162" class="Keyword">where</a>
  <a id="perm.[]"></a><a id="170" href="ic15.html#170" class="InductiveConstructor">[]</a> <a id="173" class="Symbol">:</a> <a id="175" href="ic15.html#123" class="Datatype">perm</a> <a id="180" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="183" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a>
  <a id="perm.Skip"></a><a id="188" href="ic15.html#188" class="InductiveConstructor">Skip</a> <a id="193" class="Symbol">:</a> <a id="195" class="Symbol">∀</a> <a id="197" class="Symbol">{</a><a id="198" href="ic15.html#198" class="Bound">x</a> <a id="200" class="Symbol">:</a> <a id="202" href="ic15.html#129" class="Bound">A</a><a id="203" class="Symbol">}</a> <a id="205" class="Symbol">{</a><a id="206" href="ic15.html#206" class="Bound">xs</a> <a id="209" href="ic15.html#209" class="Bound">ys</a> <a id="212" class="Symbol">:</a> <a id="214" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="219" href="ic15.html#129" class="Bound">A</a><a id="220" class="Symbol">}</a>
    <a id="226" class="Symbol">→</a> <a id="228" href="ic15.html#123" class="Datatype">perm</a> <a id="233" href="ic15.html#206" class="Bound">xs</a> <a id="236" href="ic15.html#209" class="Bound">ys</a>
    <a id="243" class="Symbol">→</a> <a id="245" href="ic15.html#123" class="Datatype">perm</a> <a id="250" class="Symbol">(</a><a id="251" href="ic15.html#198" class="Bound">x</a> <a id="253" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="255" href="ic15.html#206" class="Bound">xs</a><a id="257" class="Symbol">)</a> <a id="259" class="Symbol">(</a><a id="260" href="ic15.html#198" class="Bound">x</a> <a id="262" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="264" href="ic15.html#209" class="Bound">ys</a><a id="266" class="Symbol">)</a>
  <a id="perm.Swap"></a><a id="270" href="ic15.html#270" class="InductiveConstructor">Swap</a> <a id="275" class="Symbol">:</a> <a id="277" class="Symbol">∀</a> <a id="279" class="Symbol">{</a><a id="280" href="ic15.html#280" class="Bound">x</a> <a id="282" href="ic15.html#282" class="Bound">y</a> <a id="284" class="Symbol">:</a> <a id="286" href="ic15.html#129" class="Bound">A</a><a id="287" class="Symbol">}</a> <a id="289" class="Symbol">{</a><a id="290" href="ic15.html#290" class="Bound">xs</a> <a id="293" href="ic15.html#293" class="Bound">ys</a> <a id="296" class="Symbol">:</a> <a id="298" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="303" href="ic15.html#129" class="Bound">A</a><a id="304" class="Symbol">}</a>
    <a id="310" class="Symbol">→</a> <a id="312" href="ic15.html#123" class="Datatype">perm</a> <a id="317" href="ic15.html#290" class="Bound">xs</a> <a id="320" href="ic15.html#293" class="Bound">ys</a>
    <a id="327" class="Symbol">→</a> <a id="329" href="ic15.html#123" class="Datatype">perm</a> <a id="334" class="Symbol">(</a><a id="335" href="ic15.html#280" class="Bound">x</a> <a id="337" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="339" href="ic15.html#282" class="Bound">y</a> <a id="341" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="343" href="ic15.html#290" class="Bound">xs</a><a id="345" class="Symbol">)</a> <a id="347" class="Symbol">(</a><a id="348" href="ic15.html#282" class="Bound">y</a> <a id="350" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="352" href="ic15.html#280" class="Bound">x</a> <a id="354" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="356" href="ic15.html#290" class="Bound">xs</a><a id="358" class="Symbol">)</a>
  <a id="perm.Trans"></a><a id="362" href="ic15.html#362" class="InductiveConstructor">Trans</a> <a id="368" class="Symbol">:</a> <a id="370" class="Symbol">∀</a> <a id="372" class="Symbol">{</a><a id="373" href="ic15.html#373" class="Bound">xs</a> <a id="376" href="ic15.html#376" class="Bound">ys</a> <a id="379" href="ic15.html#379" class="Bound">zs</a> <a id="382" class="Symbol">:</a> <a id="384" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="389" href="ic15.html#129" class="Bound">A</a><a id="390" class="Symbol">}</a>
    <a id="396" class="Symbol">→</a> <a id="398" href="ic15.html#123" class="Datatype">perm</a> <a id="403" href="ic15.html#373" class="Bound">xs</a> <a id="406" href="ic15.html#376" class="Bound">ys</a>
    <a id="413" class="Symbol">→</a> <a id="415" href="ic15.html#123" class="Datatype">perm</a> <a id="420" href="ic15.html#376" class="Bound">ys</a> <a id="423" href="ic15.html#379" class="Bound">zs</a>
    <a id="430" class="Symbol">→</a> <a id="432" href="ic15.html#123" class="Datatype">perm</a> <a id="437" href="ic15.html#373" class="Bound">xs</a> <a id="440" href="ic15.html#379" class="Bound">zs</a>

<a id="444" href="ic15.html#444" class="Function">_</a> <a id="446" class="Symbol">:</a> <a id="448" href="ic15.html#123" class="Datatype">perm</a> <a id="453" href="Basics-v3.html#17186" class="InductiveConstructor Operator">[</a> <a id="455" class="Number">1</a> <a id="457" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="459" class="Number">2</a> <a id="461" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="463" class="Number">3</a> <a id="465" href="Basics-v3.html#17186" class="InductiveConstructor Operator">]</a> <a id="467" href="Basics-v3.html#17186" class="InductiveConstructor Operator">[</a> <a id="469" class="Number">3</a> <a id="471" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="473" class="Number">2</a> <a id="475" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="477" class="Number">1</a> <a id="479" href="Basics-v3.html#17186" class="InductiveConstructor Operator">]</a>
<a id="481" class="Symbol">_</a> <a id="483" class="Symbol">=</a> <a id="485" class="Symbol">{!!}</a>

<a id="491" class="Keyword">module</a> <a id="Doesn&#39;t-Work"></a><a id="498" href="ic15.html#498" class="Module">Doesn&#39;t-Work</a> <a id="511" class="Keyword">where</a>
  <a id="Doesn&#39;t-Work.¬Perm"></a><a id="519" href="ic15.html#519" class="Function">¬Perm</a> <a id="525" class="Symbol">:</a> <a id="527" href="Basics-v3.html#646" class="Function Operator">¬</a> <a id="529" href="ic15.html#123" class="Datatype">perm</a> <a id="534" href="Basics-v3.html#17186" class="InductiveConstructor Operator">[</a> <a id="536" class="Number">1</a> <a id="538" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="540" class="Number">1</a> <a id="542" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="544" class="Number">2</a> <a id="546" href="Basics-v3.html#17186" class="InductiveConstructor Operator">]</a> <a id="548" href="Basics-v3.html#17186" class="InductiveConstructor Operator">[</a> <a id="550" class="Number">1</a> <a id="552" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="554" class="Number">2</a> <a id="556" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="558" class="Number">2</a> <a id="560" href="Basics-v3.html#17186" class="InductiveConstructor Operator">]</a>
  <a id="564" href="ic15.html#519" class="Function">¬Perm</a> <a id="570" class="Symbol">=</a> <a id="572" class="Symbol">{!!}</a>

<a id="578" class="Comment">-- -------------------------- --</a>
<a id="611" class="Comment">-- tour of multiset in Basics --</a>
<a id="644" class="Comment">-- -------------------------- --</a>

<a id="678" href="ic15.html#678" class="Function">_</a> <a id="680" class="Symbol">:</a> <a id="682" href="Basics-v3.html#646" class="Function Operator">¬</a> <a id="684" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="695" href="Basics-v3.html#17186" class="InductiveConstructor Operator">[</a> <a id="697" class="Number">1</a> <a id="699" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="701" class="Number">1</a> <a id="703" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="705" class="Number">2</a> <a id="707" href="Basics-v3.html#17186" class="InductiveConstructor Operator">]</a> <a id="709" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="711" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="722" href="Basics-v3.html#17186" class="InductiveConstructor Operator">[</a> <a id="724" class="Number">1</a> <a id="726" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="728" class="Number">2</a> <a id="730" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="732" class="Number">2</a> <a id="734" href="Basics-v3.html#17186" class="InductiveConstructor Operator">]</a>
<a id="736" class="Symbol">_</a> <a id="738" class="Keyword">rewrite</a> <a id="746" href="Basics-v3.html#816" class="Function">unblock</a> <a id="754" class="Symbol">=</a> <a id="756" class="Symbol">λ</a> <a id="758" class="Symbol">()</a>

<a id="762" class="Comment">-- permutation for selection sort --</a>

<a id="800" class="Keyword">module</a> <a id="807" href="ic15.html#807" class="Module">_</a> <a id="809" class="Symbol">{</a><a id="810" href="ic15.html#810" class="Bound">A</a> <a id="812" class="Symbol">:</a> <a id="814" class="PrimitiveType">Set</a><a id="817" class="Symbol">}</a> <a id="819" class="Symbol">{{</a><a id="821" href="ic15.html#821" class="Bound">_</a> <a id="823" class="Symbol">:</a> <a id="825" href="Basics-v3.html#3944" class="Record">has[&lt;]</a> <a id="832" href="ic15.html#810" class="Bound">A</a><a id="833" class="Symbol">}}</a> <a id="836" class="Symbol">{{</a><a id="838" href="ic15.html#838" class="Bound">_</a> <a id="840" class="Symbol">:</a> <a id="842" href="Basics-v3.html#4162" class="Record">cor[&lt;]</a> <a id="849" href="ic15.html#810" class="Bound">A</a><a id="850" class="Symbol">}}</a> <a id="853" class="Symbol">{{</a><a id="855" href="ic15.html#855" class="Bound">_</a> <a id="857" class="Symbol">:</a> <a id="859" href="Basics-v3.html#5578" class="Record">has[&lt;?]</a> <a id="867" href="ic15.html#810" class="Bound">A</a><a id="868" class="Symbol">}}</a> <a id="871" class="Symbol">{{</a><a id="873" href="ic15.html#873" class="Bound">_</a> <a id="875" class="Symbol">:</a> <a id="877" href="Basics-v3.html#7407" class="Record">cor[&lt;?]</a> <a id="885" href="ic15.html#810" class="Bound">A</a><a id="886" class="Symbol">}}</a> <a id="889" class="Keyword">where</a>
  <a id="897" href="ic15.html#897" class="Function">find-min</a> <a id="906" class="Symbol">:</a> <a id="908" href="ic15.html#810" class="Bound">A</a> <a id="910" class="Symbol">→</a> <a id="912" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="917" href="ic15.html#810" class="Bound">A</a> <a id="919" class="Symbol">→</a> <a id="921" href="ic15.html#810" class="Bound">A</a> <a id="923" href="Basics-v3.html#968" class="Record Operator">∧</a> <a id="925" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="930" href="ic15.html#810" class="Bound">A</a>
  <a id="934" href="ic15.html#897" class="Function">find-min</a> <a id="943" href="ic15.html#943" class="Bound">x</a> <a id="945" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="948" class="Symbol">=</a> <a id="950" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="952" href="ic15.html#943" class="Bound">x</a> <a id="954" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="956" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="959" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a>
  <a id="963" href="ic15.html#897" class="Function">find-min</a> <a id="972" href="ic15.html#972" class="Bound">x</a> <a id="974" class="Symbol">(</a><a id="975" href="ic15.html#975" class="Bound">y</a> <a id="977" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="979" href="ic15.html#979" class="Bound">xs</a><a id="981" class="Symbol">)</a> <a id="983" class="Keyword">with</a> <a id="988" href="ic15.html#972" class="Bound">x</a> <a id="990" href="Basics-v3.html#5700" class="Field Operator">≤?</a> <a id="993" href="ic15.html#975" class="Bound">y</a>
  <a id="997" class="Symbol">…</a> <a id="999" class="Symbol">|</a> <a id="1001" href="Basics-v3.html#5415" class="InductiveConstructor">LE</a> <a id="1004" class="Symbol">=</a> <a id="1006" class="Keyword">let</a> <a id="1010" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1012" href="ic15.html#1012" class="Bound">m</a> <a id="1014" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="1016" href="ic15.html#1016" class="Bound">ys</a> <a id="1019" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="1021" class="Symbol">=</a> <a id="1023" href="ic15.html#897" class="Function">find-min</a> <a id="1032" class="Bound">x</a> <a id="1034" class="Bound">xs</a> <a id="1037" class="Keyword">in</a> <a id="1040" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1042" href="ic15.html#1012" class="Bound">m</a> <a id="1044" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="1046" class="Bound">y</a> <a id="1048" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="1050" href="ic15.html#1016" class="Bound">ys</a> <a id="1053" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a>
  <a id="1057" class="Symbol">…</a> <a id="1059" class="Symbol">|</a> <a id="1061" href="Basics-v3.html#5430" class="InductiveConstructor">GT</a> <a id="1064" class="Symbol">=</a> <a id="1066" class="Keyword">let</a> <a id="1070" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1072" href="ic15.html#1072" class="Bound">m</a> <a id="1074" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="1076" href="ic15.html#1076" class="Bound">ys</a> <a id="1079" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="1081" class="Symbol">=</a> <a id="1083" href="ic15.html#897" class="Function">find-min</a> <a id="1092" class="Bound">y</a> <a id="1094" class="Bound">xs</a> <a id="1097" class="Keyword">in</a> <a id="1100" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1102" href="ic15.html#1072" class="Bound">m</a> <a id="1104" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="1106" class="Bound">x</a> <a id="1108" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="1110" href="ic15.html#1076" class="Bound">ys</a> <a id="1113" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a>

  <a id="1118" href="ic15.html#1118" class="Function">find-min-length</a> <a id="1134" class="Symbol">:</a> <a id="1136" class="Symbol">∀</a> <a id="1138" class="Symbol">(</a><a id="1139" href="ic15.html#1139" class="Bound">y</a> <a id="1141" class="Symbol">:</a> <a id="1143" href="ic15.html#810" class="Bound">A</a><a id="1144" class="Symbol">)</a> <a id="1146" class="Symbol">(</a><a id="1147" href="ic15.html#1147" class="Bound">xs</a> <a id="1150" class="Symbol">:</a> <a id="1152" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="1157" href="ic15.html#810" class="Bound">A</a><a id="1158" class="Symbol">)</a> <a id="1160" class="Symbol">→</a> <a id="1162" class="Keyword">let</a> <a id="1166" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1168" href="ic15.html#1168" class="Bound">m</a> <a id="1170" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="1172" href="ic15.html#1172" class="Bound">xs′</a> <a id="1176" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="1178" class="Symbol">=</a> <a id="1180" href="ic15.html#897" class="Function">find-min</a> <a id="1189" href="ic15.html#1139" class="Bound">y</a> <a id="1191" href="ic15.html#1147" class="Bound">xs</a> <a id="1194" class="Keyword">in</a> <a id="1197" href="Basics-v3.html#18551" class="Function">length</a> <a id="1204" href="ic15.html#1147" class="Bound">xs</a> <a id="1207" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="1209" href="Basics-v3.html#18551" class="Function">length</a> <a id="1216" href="ic15.html#1172" class="Bound">xs′</a>
  <a id="1222" href="ic15.html#1118" class="Function">find-min-length</a> <a id="1238" href="ic15.html#1238" class="Bound">y</a> <a id="1240" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="1243" class="Symbol">=</a> <a id="1245" href="Basics-v3.html#365" class="InductiveConstructor">refl</a>
  <a id="1252" href="ic15.html#1118" class="Function">find-min-length</a> <a id="1268" href="ic15.html#1268" class="Bound">y</a> <a id="1270" class="Symbol">(</a><a id="1271" href="ic15.html#1271" class="Bound">x</a> <a id="1273" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="1275" href="ic15.html#1275" class="Bound">xs</a><a id="1277" class="Symbol">)</a> <a id="1279" class="Keyword">with</a> <a id="1284" href="ic15.html#1268" class="Bound">y</a> <a id="1286" href="Basics-v3.html#5700" class="Field Operator">≤?</a> <a id="1289" href="ic15.html#1271" class="Bound">x</a>
  <a id="1293" class="Symbol">…</a> <a id="1295" class="Symbol">|</a> <a id="1297" href="Basics-v3.html#5415" class="InductiveConstructor">LE</a> <a id="1300" class="Keyword">rewrite</a> <a id="1308" href="ic15.html#1118" class="Function">find-min-length</a> <a id="1324" class="Bound">y</a> <a id="1326" class="Bound">xs</a> <a id="1329" class="Symbol">=</a> <a id="1331" href="Basics-v3.html#365" class="InductiveConstructor">refl</a>
  <a id="1338" class="Symbol">…</a> <a id="1340" class="Symbol">|</a> <a id="1342" href="Basics-v3.html#5430" class="InductiveConstructor">GT</a> <a id="1345" class="Keyword">rewrite</a> <a id="1353" href="ic15.html#1118" class="Function">find-min-length</a> <a id="1369" class="Bound">x</a> <a id="1371" class="Bound">xs</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="Basics-v3.html#365" class="InductiveConstructor">refl</a>

  <a id="1384" href="ic15.html#1384" class="Function">find-min-perm</a> <a id="1398" class="Symbol">:</a> <a id="1400" class="Symbol">∀</a> <a id="1402" class="Symbol">(</a><a id="1403" href="ic15.html#1403" class="Bound">x</a> <a id="1405" class="Symbol">:</a> <a id="1407" href="ic15.html#810" class="Bound">A</a><a id="1408" class="Symbol">)</a> <a id="1410" class="Symbol">(</a><a id="1411" href="ic15.html#1411" class="Bound">xs</a> <a id="1414" class="Symbol">:</a> <a id="1416" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="1421" href="ic15.html#810" class="Bound">A</a><a id="1422" class="Symbol">)</a> <a id="1424" class="Symbol">→</a> <a id="1426" class="Keyword">let</a> <a id="1430" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1432" href="ic15.html#1432" class="Bound">m</a> <a id="1434" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="1436" href="ic15.html#1436" class="Bound">ys</a> <a id="1439" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="1441" class="Symbol">=</a> <a id="1443" href="ic15.html#897" class="Function">find-min</a> <a id="1452" href="ic15.html#1403" class="Bound">x</a> <a id="1454" href="ic15.html#1411" class="Bound">xs</a> <a id="1457" class="Keyword">in</a> <a id="1460" href="Basics-v3.html#24332" class="Function Operator">b[</a> <a id="1463" href="ic15.html#1432" class="Bound">m</a> <a id="1465" href="Basics-v3.html#24332" class="Function Operator">]</a> <a id="1467" href="Basics-v3.html#2303" class="Field Operator">+</a> <a id="1469" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="1480" href="ic15.html#1436" class="Bound">ys</a> <a id="1483" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="1485" href="Basics-v3.html#24332" class="Function Operator">b[</a> <a id="1488" href="ic15.html#1403" class="Bound">x</a> <a id="1490" href="Basics-v3.html#24332" class="Function Operator">]</a> <a id="1492" href="Basics-v3.html#2303" class="Field Operator">+</a> <a id="1494" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="1505" href="ic15.html#1411" class="Bound">xs</a>
  <a id="1510" href="ic15.html#1384" class="Function">find-min-perm</a> <a id="1524" href="ic15.html#1524" class="Bound">x</a> <a id="1526" href="ic15.html#1526" class="Bound">xs</a> <a id="1529" class="Symbol">=</a> <a id="1531" class="Symbol">{!!}</a>

  <a id="1539" href="ic15.html#1539" class="Function">ssort′</a> <a id="1546" class="Symbol">:</a> <a id="1548" class="Symbol">∀</a> <a id="1550" class="Symbol">(</a><a id="1551" href="ic15.html#1551" class="Bound">xs</a> <a id="1554" class="Symbol">:</a> <a id="1556" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="1561" href="ic15.html#810" class="Bound">A</a><a id="1562" class="Symbol">)</a> <a id="1564" class="Symbol">→</a> <a id="1566" href="Basics-v3.html#25984" class="Datatype">acc</a> <a id="1570" href="Basics-v3.html#4016" class="Field Operator">_&lt;_</a> <a id="1574" class="Symbol">(</a><a id="1575" href="Basics-v3.html#18551" class="Function">length</a> <a id="1582" href="ic15.html#1551" class="Bound">xs</a><a id="1584" class="Symbol">)</a> <a id="1586" class="Symbol">→</a> <a id="1588" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="1593" href="ic15.html#810" class="Bound">A</a>
  <a id="1597" href="ic15.html#1539" class="Function">ssort′</a> <a id="1604" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="1607" class="Symbol">_</a> <a id="1609" class="Symbol">=</a> <a id="1611" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a>
  <a id="1616" href="ic15.html#1539" class="Function">ssort′</a> <a id="1623" class="Symbol">(</a><a id="1624" href="ic15.html#1624" class="Bound">x</a> <a id="1626" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="1628" href="ic15.html#1628" class="Bound">xs</a><a id="1630" class="Symbol">)</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Basics-v3.html#26040" class="InductiveConstructor">Acc</a> <a id="1637" href="ic15.html#1637" class="Bound">r</a><a id="1638" class="Symbol">)</a> <a id="1640" class="Keyword">with</a> <a id="1645" href="ic15.html#897" class="Function">find-min</a> <a id="1654" href="ic15.html#1624" class="Bound">x</a> <a id="1656" href="ic15.html#1628" class="Bound">xs</a> <a id="1659" class="Symbol">|</a> <a id="1661" href="ic15.html#1118" class="Function">find-min-length</a> <a id="1677" href="ic15.html#1624" class="Bound">x</a> <a id="1679" href="ic15.html#1628" class="Bound">xs</a>
  <a id="1684" class="Symbol">…</a> <a id="1686" class="Symbol">|</a> <a id="1688" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1690" href="ic15.html#1690" class="Bound">m</a> <a id="1692" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="1694" href="ic15.html#1694" class="Bound">ys</a> <a id="1697" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="1699" class="Symbol">|</a> <a id="1701" href="ic15.html#1701" class="Bound">H</a> <a id="1703" class="Symbol">=</a> <a id="1705" href="ic15.html#1690" class="Bound">m</a> <a id="1707" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="1709" href="ic15.html#1539" class="Function">ssort′</a> <a id="1716" href="ic15.html#1694" class="Bound">ys</a> <a id="1719" class="Symbol">(</a><a id="1720" class="Bound">r</a> <a id="1722" class="Symbol">(</a><a id="1723" href="Basics-v3.html#12247" class="Function">≤-to-&lt;</a> <a id="1730" class="Symbol">(</a><a id="1731" href="Basics-v3.html#5242" class="Function">≤-refl-≡</a> <a id="1740" class="Symbol">_</a> <a id="1742" class="Symbol">_</a> <a id="1744" class="Symbol">(</a><a id="1745" href="Basics-v3.html#409" class="Function">sym</a> <a id="1749" href="ic15.html#1701" class="Bound">H</a><a id="1750" class="Symbol">))))</a>

  <a id="1758" href="ic15.html#1758" class="Function">ssort</a> <a id="1764" class="Symbol">:</a> <a id="1766" class="Symbol">∀</a> <a id="1768" class="Symbol">(</a><a id="1769" href="ic15.html#1769" class="Bound">xs</a> <a id="1772" class="Symbol">:</a> <a id="1774" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="1779" href="ic15.html#810" class="Bound">A</a><a id="1780" class="Symbol">)</a> <a id="1782" class="Symbol">→</a> <a id="1784" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="1789" href="ic15.html#810" class="Bound">A</a>
  <a id="1793" href="ic15.html#1758" class="Function">ssort</a> <a id="1799" href="ic15.html#1799" class="Bound">xs</a> <a id="1802" class="Symbol">=</a> <a id="1804" href="ic15.html#1539" class="Function">ssort′</a> <a id="1811" href="ic15.html#1799" class="Bound">xs</a> <a id="1814" class="Symbol">(</a><a id="1815" href="Basics-v3.html#26276" class="Field">wf</a> <a id="1818" class="Symbol">(</a><a id="1819" href="Basics-v3.html#18551" class="Function">length</a> <a id="1826" href="ic15.html#1799" class="Bound">xs</a><a id="1828" class="Symbol">))</a>

  <a id="1834" href="ic15.html#1834" class="Function">ssort′-perm</a> <a id="1846" class="Symbol">:</a> <a id="1848" class="Symbol">∀</a> <a id="1850" class="Symbol">(</a><a id="1851" href="ic15.html#1851" class="Bound">xs</a> <a id="1854" class="Symbol">:</a> <a id="1856" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="1861" href="ic15.html#810" class="Bound">A</a><a id="1862" class="Symbol">)</a> <a id="1864" class="Symbol">(</a><a id="1865" href="ic15.html#1865" class="Bound">ε</a> <a id="1867" class="Symbol">:</a> <a id="1869" href="Basics-v3.html#25984" class="Datatype">acc</a> <a id="1873" href="Basics-v3.html#4016" class="Field Operator">_&lt;_</a> <a id="1877" class="Symbol">(</a><a id="1878" href="Basics-v3.html#18551" class="Function">length</a> <a id="1885" href="ic15.html#1851" class="Bound">xs</a><a id="1887" class="Symbol">))</a> <a id="1890" class="Symbol">→</a> <a id="1892" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="1903" class="Symbol">(</a><a id="1904" href="ic15.html#1539" class="Function">ssort′</a> <a id="1911" href="ic15.html#1851" class="Bound">xs</a> <a id="1914" href="ic15.html#1865" class="Bound">ε</a><a id="1915" class="Symbol">)</a> <a id="1917" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="1919" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="1930" href="ic15.html#1851" class="Bound">xs</a>
  <a id="1935" href="ic15.html#1834" class="Function">ssort′-perm</a> <a id="1947" href="ic15.html#1947" class="Bound">xs</a> <a id="1950" href="ic15.html#1950" class="Bound">a</a> <a id="1952" class="Symbol">=</a> <a id="1954" class="Symbol">{!!}</a>

<a id="1960" class="Comment">-- merge sort --</a>

<a id="1978" class="Keyword">module</a> <a id="1985" href="ic15.html#1985" class="Module">_</a> <a id="1987" class="Symbol">{</a><a id="1988" href="ic15.html#1988" class="Bound">A</a> <a id="1990" class="Symbol">:</a> <a id="1992" class="PrimitiveType">Set</a><a id="1995" class="Symbol">}</a> <a id="1997" class="Symbol">{{</a><a id="1999" href="ic15.html#1999" class="Bound">_</a> <a id="2001" class="Symbol">:</a> <a id="2003" href="Basics-v3.html#5578" class="Record">has[&lt;?]</a> <a id="2011" href="ic15.html#1988" class="Bound">A</a><a id="2012" class="Symbol">}}</a> <a id="2015" class="Keyword">where</a>

  <a id="2024" href="ic15.html#2024" class="Function">split</a> <a id="2030" class="Symbol">:</a> <a id="2032" href="ic15.html#1988" class="Bound">A</a> <a id="2034" class="Symbol">→</a> <a id="2036" href="ic15.html#1988" class="Bound">A</a> <a id="2038" class="Symbol">→</a> <a id="2040" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2045" href="ic15.html#1988" class="Bound">A</a> <a id="2047" class="Symbol">→</a> <a id="2049" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2054" href="ic15.html#1988" class="Bound">A</a> <a id="2056" href="Basics-v3.html#968" class="Record Operator">∧</a> <a id="2058" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2063" href="ic15.html#1988" class="Bound">A</a>
  <a id="2067" href="ic15.html#2024" class="Function">split</a> <a id="2073" href="ic15.html#2073" class="Bound">x</a> <a id="2075" href="ic15.html#2075" class="Bound">y</a> <a id="2077" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="2080" class="Symbol">=</a> <a id="2082" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2084" href="Basics-v3.html#17133" class="InductiveConstructor Operator">[</a> <a id="2086" href="ic15.html#2073" class="Bound">x</a> <a id="2088" href="Basics-v3.html#17133" class="InductiveConstructor Operator">]</a> <a id="2090" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2092" href="Basics-v3.html#17133" class="InductiveConstructor Operator">[</a> <a id="2094" href="ic15.html#2075" class="Bound">y</a> <a id="2096" href="Basics-v3.html#17133" class="InductiveConstructor Operator">]</a> <a id="2098" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a>
  <a id="2102" href="ic15.html#2024" class="Function">split</a> <a id="2108" href="ic15.html#2108" class="Bound">x</a> <a id="2110" href="ic15.html#2110" class="Bound">y</a> <a id="2112" class="Symbol">(</a><a id="2113" href="ic15.html#2113" class="Bound">z</a> <a id="2115" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2117" href="ic15.html#2117" class="Bound">xs</a><a id="2119" class="Symbol">)</a> <a id="2121" class="Symbol">=</a> <a id="2123" class="Keyword">let</a> <a id="2127" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2129" href="ic15.html#2129" class="Bound">ys</a> <a id="2132" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2134" href="ic15.html#2134" class="Bound">zs</a> <a id="2137" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="2139" class="Symbol">=</a> <a id="2141" href="ic15.html#2024" class="Function">split</a> <a id="2147" href="ic15.html#2110" class="Bound">y</a> <a id="2149" href="ic15.html#2113" class="Bound">z</a> <a id="2151" href="ic15.html#2117" class="Bound">xs</a> <a id="2154" class="Keyword">in</a> <a id="2157" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2159" href="ic15.html#2108" class="Bound">x</a> <a id="2161" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2163" href="ic15.html#2134" class="Bound">zs</a> <a id="2166" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2168" href="ic15.html#2129" class="Bound">ys</a> <a id="2171" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a>

  <a id="2176" href="ic15.html#2176" class="Function">split-length</a> <a id="2189" class="Symbol">:</a> <a id="2191" class="Symbol">∀</a> <a id="2193" class="Symbol">(</a><a id="2194" href="ic15.html#2194" class="Bound">x</a> <a id="2196" href="ic15.html#2196" class="Bound">y</a> <a id="2198" class="Symbol">:</a> <a id="2200" href="ic15.html#1988" class="Bound">A</a><a id="2201" class="Symbol">)</a> <a id="2203" class="Symbol">(</a><a id="2204" href="ic15.html#2204" class="Bound">xs</a> <a id="2207" class="Symbol">:</a> <a id="2209" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2214" href="ic15.html#1988" class="Bound">A</a><a id="2215" class="Symbol">)</a> <a id="2217" class="Symbol">→</a> <a id="2219" class="Keyword">let</a> <a id="2223" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2225" href="ic15.html#2225" class="Bound">ys</a> <a id="2228" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2230" href="ic15.html#2230" class="Bound">zs</a> <a id="2233" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="2235" class="Symbol">=</a> <a id="2237" href="ic15.html#2024" class="Function">split</a> <a id="2243" href="ic15.html#2194" class="Bound">x</a> <a id="2245" href="ic15.html#2196" class="Bound">y</a> <a id="2247" href="ic15.html#2204" class="Bound">xs</a>
                                              <a id="2296" class="Keyword">in</a> <a id="2299" href="Basics-v3.html#18551" class="Function">length</a> <a id="2306" href="ic15.html#2225" class="Bound">ys</a> <a id="2309" href="Basics-v3.html#4016" class="Field Operator">&lt;</a> <a id="2311" href="Basics-v3.html#18551" class="Function">length</a> <a id="2318" class="Symbol">(</a><a id="2319" href="ic15.html#2194" class="Bound">x</a> <a id="2321" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2323" href="ic15.html#2196" class="Bound">y</a> <a id="2325" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2327" href="ic15.html#2204" class="Bound">xs</a><a id="2329" class="Symbol">)</a>
                                               <a id="2378" href="Basics-v3.html#968" class="Record Operator">∧</a> <a id="2380" href="Basics-v3.html#18551" class="Function">length</a> <a id="2387" href="ic15.html#2230" class="Bound">zs</a> <a id="2390" href="Basics-v3.html#4016" class="Field Operator">&lt;</a> <a id="2392" href="Basics-v3.html#18551" class="Function">length</a> <a id="2399" class="Symbol">(</a><a id="2400" href="ic15.html#2194" class="Bound">x</a> <a id="2402" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2404" href="ic15.html#2196" class="Bound">y</a> <a id="2406" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2408" href="ic15.html#2204" class="Bound">xs</a><a id="2410" class="Symbol">)</a>
  <a id="2414" href="ic15.html#2176" class="Function">split-length</a> <a id="2427" href="ic15.html#2427" class="Bound">x</a> <a id="2429" href="ic15.html#2429" class="Bound">y</a> <a id="2431" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="2434" class="Symbol">=</a> <a id="2436" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2438" href="Basics-v3.html#12112" class="InductiveConstructor">Suc</a> <a id="2442" href="Basics-v3.html#12073" class="InductiveConstructor">Zero</a> <a id="2447" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2449" href="Basics-v3.html#12112" class="InductiveConstructor">Suc</a> <a id="2453" href="Basics-v3.html#12073" class="InductiveConstructor">Zero</a> <a id="2458" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a>
  <a id="2462" href="ic15.html#2176" class="Function">split-length</a> <a id="2475" href="ic15.html#2475" class="Bound">w</a> <a id="2477" href="ic15.html#2477" class="Bound">x</a> <a id="2479" class="Symbol">(</a><a id="2480" href="ic15.html#2480" class="Bound">y</a> <a id="2482" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2484" href="ic15.html#2484" class="Bound">xs</a><a id="2486" class="Symbol">)</a> <a id="2488" class="Keyword">with</a> <a id="2493" href="ic15.html#2024" class="Function">split</a> <a id="2499" href="ic15.html#2477" class="Bound">x</a> <a id="2501" href="ic15.html#2480" class="Bound">y</a> <a id="2503" href="ic15.html#2484" class="Bound">xs</a> <a id="2506" class="Symbol">|</a> <a id="2508" href="ic15.html#2176" class="Function">split-length</a> <a id="2521" href="ic15.html#2477" class="Bound">x</a> <a id="2523" href="ic15.html#2480" class="Bound">y</a> <a id="2525" href="ic15.html#2484" class="Bound">xs</a>
  <a id="2530" class="Symbol">…</a> <a id="2532" class="Symbol">|</a> <a id="2534" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2536" href="ic15.html#2536" class="Bound">ys</a> <a id="2539" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2541" href="ic15.html#2541" class="Bound">zs</a> <a id="2544" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="2546" class="Symbol">|</a> <a id="2548" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2550" href="ic15.html#2550" class="Bound">IH₁</a> <a id="2554" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2556" href="ic15.html#2556" class="Bound">IH₂</a> <a id="2560" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="2562" class="Symbol">=</a> <a id="2564" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2566" href="Basics-v3.html#12112" class="InductiveConstructor">Suc</a> <a id="2570" href="ic15.html#2556" class="Bound">IH₂</a> <a id="2574" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2576" href="Basics-v3.html#14443" class="Function">&lt;ᴺ-lmono</a> <a id="2585" class="Symbol">(</a><a id="2586" href="Basics-v3.html#18551" class="Function">length</a> <a id="2593" href="ic15.html#2536" class="Bound">ys</a><a id="2595" class="Symbol">)</a> <a id="2597" class="Number">1</a> <a id="2599" class="Symbol">(</a><a id="2600" class="Number">2</a> <a id="2602" href="Basics-v3.html#2303" class="Field Operator">+</a> <a id="2604" href="Basics-v3.html#18551" class="Function">length</a> <a id="2611" class="Bound">xs</a><a id="2613" class="Symbol">)</a> <a id="2615" href="ic15.html#2550" class="Bound">IH₁</a> <a id="2619" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a>

  <a id="2624" href="ic15.html#2624" class="Function">merge</a> <a id="2630" class="Symbol">:</a> <a id="2632" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2637" href="ic15.html#1988" class="Bound">A</a> <a id="2639" class="Symbol">→</a> <a id="2641" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2646" href="ic15.html#1988" class="Bound">A</a> <a id="2648" class="Symbol">→</a> <a id="2650" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2655" href="ic15.html#1988" class="Bound">A</a>
  <a id="2659" href="ic15.html#2624" class="Function">merge</a> <a id="2665" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="2668" href="ic15.html#2668" class="Bound">ys</a> <a id="2671" class="Symbol">=</a> <a id="2673" href="ic15.html#2668" class="Bound">ys</a>
  <a id="2678" href="ic15.html#2624" class="CatchallClause Function">merge</a><a id="2683" class="CatchallClause"> </a><a id="2684" href="ic15.html#2684" class="CatchallClause Bound">xs</a><a id="2686" class="CatchallClause"> </a><a id="2687" href="Basics-v3.html#17084" class="CatchallClause InductiveConstructor">[]</a> <a id="2690" class="Symbol">=</a> <a id="2692" href="ic15.html#2684" class="Bound">xs</a>
  <a id="2697" href="ic15.html#2624" class="Function">merge</a> <a id="2703" class="Symbol">(</a><a id="2704" href="ic15.html#2704" class="Bound">x</a> <a id="2706" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2708" href="ic15.html#2708" class="Bound">xs</a><a id="2710" class="Symbol">)</a> <a id="2712" class="Symbol">(</a><a id="2713" href="ic15.html#2713" class="Bound">y</a> <a id="2715" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2717" href="ic15.html#2717" class="Bound">ys</a><a id="2719" class="Symbol">)</a> <a id="2721" class="Keyword">with</a> <a id="2726" href="ic15.html#2704" class="Bound">x</a> <a id="2728" href="Basics-v3.html#5700" class="Field Operator">≤?</a> <a id="2731" href="ic15.html#2713" class="Bound">y</a>
  <a id="2735" class="Symbol">…</a> <a id="2737" class="Symbol">|</a> <a id="2739" href="Basics-v3.html#5415" class="InductiveConstructor">LE</a> <a id="2742" class="Symbol">=</a> <a id="2744" class="Bound">x</a> <a id="2746" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2748" href="ic15.html#2624" class="Function">merge</a> <a id="2754" class="Bound">xs</a> <a id="2757" class="Symbol">(</a><a id="2758" class="Bound">y</a> <a id="2760" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2762" class="Bound">ys</a><a id="2764" class="Symbol">)</a>
  <a id="2768" class="Symbol">…</a> <a id="2770" class="Symbol">|</a> <a id="2772" href="Basics-v3.html#5430" class="InductiveConstructor">GT</a> <a id="2775" class="Symbol">=</a> <a id="2777" class="Bound">y</a> <a id="2779" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2781" href="ic15.html#2624" class="Function">merge</a> <a id="2787" class="Symbol">(</a><a id="2788" class="Bound">x</a> <a id="2790" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2792" class="Bound">xs</a><a id="2794" class="Symbol">)</a> <a id="2796" class="Bound">ys</a>

  <a id="2802" href="ic15.html#2802" class="Function">msort′</a> <a id="2809" class="Symbol">:</a> <a id="2811" class="Symbol">∀</a> <a id="2813" class="Symbol">(</a><a id="2814" href="ic15.html#2814" class="Bound">xs</a> <a id="2817" class="Symbol">:</a> <a id="2819" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2824" href="ic15.html#1988" class="Bound">A</a><a id="2825" class="Symbol">)</a> <a id="2827" class="Symbol">→</a> <a id="2829" href="Basics-v3.html#25984" class="Datatype">acc</a> <a id="2833" href="Basics-v3.html#4016" class="Field Operator">_&lt;_</a> <a id="2837" class="Symbol">(</a><a id="2838" href="Basics-v3.html#18551" class="Function">length</a> <a id="2845" href="ic15.html#2814" class="Bound">xs</a><a id="2847" class="Symbol">)</a> <a id="2849" class="Symbol">→</a> <a id="2851" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="2856" href="ic15.html#1988" class="Bound">A</a>
  <a id="2860" href="ic15.html#2802" class="Function">msort′</a> <a id="2867" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a> <a id="2870" class="Symbol">_</a> <a id="2872" class="Symbol">=</a> <a id="2874" href="Basics-v3.html#17084" class="InductiveConstructor">[]</a>
  <a id="2879" href="ic15.html#2802" class="Function">msort′</a> <a id="2886" href="Basics-v3.html#17133" class="InductiveConstructor Operator">[</a> <a id="2888" href="ic15.html#2888" class="Bound">x</a> <a id="2890" href="Basics-v3.html#17133" class="InductiveConstructor Operator">]</a> <a id="2892" class="Symbol">_</a> <a id="2894" class="Symbol">=</a> <a id="2896" href="Basics-v3.html#17133" class="InductiveConstructor Operator">[</a> <a id="2898" href="ic15.html#2888" class="Bound">x</a> <a id="2900" href="Basics-v3.html#17133" class="InductiveConstructor Operator">]</a>
  <a id="2904" href="ic15.html#2802" class="Function">msort′</a> <a id="2911" class="Symbol">(</a><a id="2912" href="ic15.html#2912" class="Bound">x</a> <a id="2914" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2916" href="ic15.html#2916" class="Bound">y</a> <a id="2918" href="Basics-v3.html#17098" class="InductiveConstructor Operator">∷</a> <a id="2920" href="ic15.html#2920" class="Bound">xs</a><a id="2922" class="Symbol">)</a> <a id="2924" class="Symbol">(</a><a id="2925" href="Basics-v3.html#26040" class="InductiveConstructor">Acc</a> <a id="2929" href="ic15.html#2929" class="Bound">r</a><a id="2930" class="Symbol">)</a> <a id="2932" class="Symbol">=</a>
    <a id="2938" class="Keyword">let</a> <a id="2942" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="2944" href="ic15.html#2944" class="Bound">ys</a> <a id="2947" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="2949" href="ic15.html#2949" class="Bound">zs</a> <a id="2952" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="2954" class="Symbol">=</a> <a id="2956" href="ic15.html#2024" class="Function">split</a> <a id="2962" href="ic15.html#2912" class="Bound">x</a> <a id="2964" href="ic15.html#2916" class="Bound">y</a> <a id="2966" href="ic15.html#2920" class="Bound">xs</a>
    <a id="2973" class="Keyword">in</a> <a id="2976" href="ic15.html#2624" class="Function">merge</a> <a id="2982" class="Symbol">(</a><a id="2983" href="ic15.html#2802" class="Function">msort′</a> <a id="2990" href="ic15.html#2944" class="Bound">ys</a> <a id="2993" class="Symbol">(</a><a id="2994" href="ic15.html#2929" class="Bound">r</a> <a id="2996" class="Symbol">(</a><a id="2997" href="Basics-v3.html#1028" class="Field">fst</a> <a id="3001" class="Symbol">(</a><a id="3002" href="ic15.html#2176" class="Function">split-length</a> <a id="3015" href="ic15.html#2912" class="Bound">x</a> <a id="3017" href="ic15.html#2916" class="Bound">y</a> <a id="3019" href="ic15.html#2920" class="Bound">xs</a><a id="3021" class="Symbol">))))</a>
             <a id="3039" class="Symbol">(</a><a id="3040" href="ic15.html#2802" class="Function">msort′</a> <a id="3047" href="ic15.html#2949" class="Bound">zs</a> <a id="3050" class="Symbol">(</a><a id="3051" href="ic15.html#2929" class="Bound">r</a> <a id="3053" class="Symbol">(</a><a id="3054" href="Basics-v3.html#1040" class="Field">snd</a> <a id="3058" class="Symbol">(</a><a id="3059" href="ic15.html#2176" class="Function">split-length</a> <a id="3072" href="ic15.html#2912" class="Bound">x</a> <a id="3074" href="ic15.html#2916" class="Bound">y</a> <a id="3076" href="ic15.html#2920" class="Bound">xs</a><a id="3078" class="Symbol">))))</a>

  <a id="3086" href="ic15.html#3086" class="Function">msort</a> <a id="3092" class="Symbol">:</a> <a id="3094" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="3099" href="ic15.html#1988" class="Bound">A</a> <a id="3101" class="Symbol">→</a> <a id="3103" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="3108" href="ic15.html#1988" class="Bound">A</a>
  <a id="3112" href="ic15.html#3086" class="Function">msort</a> <a id="3118" href="ic15.html#3118" class="Bound">xs</a> <a id="3121" class="Symbol">=</a> <a id="3123" href="ic15.html#2802" class="Function">msort′</a> <a id="3130" href="ic15.html#3118" class="Bound">xs</a> <a id="3133" class="Symbol">(</a><a id="3134" href="Basics-v3.html#26276" class="Field">wf</a> <a id="3137" class="Symbol">(</a><a id="3138" href="Basics-v3.html#18551" class="Function">length</a> <a id="3145" href="ic15.html#3118" class="Bound">xs</a><a id="3147" class="Symbol">))</a>

<a id="3151" href="ic15.html#3151" class="Function">_</a> <a id="3153" class="Symbol">:</a> <a id="3155" href="ic15.html#2024" class="Function">split</a> <a id="3161" class="Number">1</a> <a id="3163" class="Number">2</a> <a id="3165" href="Basics-v3.html#17224" class="InductiveConstructor Operator">[</a> <a id="3167" class="Number">3</a> <a id="3169" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3171" class="Number">4</a> <a id="3173" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3175" class="Number">5</a> <a id="3177" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3179" class="Number">6</a> <a id="3181" href="Basics-v3.html#17224" class="InductiveConstructor Operator">]</a> <a id="3183" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="3185" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="3187" href="Basics-v3.html#17186" class="InductiveConstructor Operator">[</a> <a id="3189" class="Number">1</a> <a id="3191" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="3193" class="Number">3</a> <a id="3195" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="3197" class="Number">5</a> <a id="3199" href="Basics-v3.html#17186" class="InductiveConstructor Operator">]</a> <a id="3201" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="3203" href="Basics-v3.html#17186" class="InductiveConstructor Operator">[</a> <a id="3205" class="Number">2</a> <a id="3207" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="3209" class="Number">4</a> <a id="3211" href="Basics-v3.html#17186" class="InductiveConstructor Operator">,</a> <a id="3213" class="Number">6</a> <a id="3215" href="Basics-v3.html#17186" class="InductiveConstructor Operator">]</a> <a id="3217" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a>
<a id="3219" class="Symbol">_</a> <a id="3221" class="Symbol">=</a> <a id="3223" href="Basics-v3.html#365" class="InductiveConstructor">refl</a>

<a id="3229" href="ic15.html#3229" class="Function">_</a> <a id="3231" class="Symbol">:</a> <a id="3233" href="ic15.html#3086" class="Function">msort</a> <a id="3239" href="Basics-v3.html#17224" class="InductiveConstructor Operator">[</a> <a id="3241" class="Number">4</a> <a id="3243" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3245" class="Number">2</a> <a id="3247" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3249" class="Number">1</a> <a id="3251" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3253" class="Number">3</a> <a id="3255" href="Basics-v3.html#17224" class="InductiveConstructor Operator">]</a>  <a id="3258" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="3260" href="Basics-v3.html#17224" class="InductiveConstructor Operator">[</a> <a id="3262" class="Number">1</a> <a id="3264" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3266" class="Number">2</a> <a id="3268" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3270" class="Number">3</a> <a id="3272" href="Basics-v3.html#17224" class="InductiveConstructor Operator">,</a> <a id="3274" class="Number">4</a> <a id="3276" href="Basics-v3.html#17224" class="InductiveConstructor Operator">]</a>
<a id="3278" class="Symbol">_</a> <a id="3280" class="Symbol">=</a> <a id="3282" href="Basics-v3.html#365" class="InductiveConstructor">refl</a>

<a id="3288" class="Comment">-- next homework --</a>

<a id="3309" class="Keyword">module</a> <a id="3316" href="ic15.html#3316" class="Module">_</a> <a id="3318" class="Symbol">{</a><a id="3319" href="ic15.html#3319" class="Bound">A</a> <a id="3321" class="Symbol">:</a> <a id="3323" class="PrimitiveType">Set</a><a id="3326" class="Symbol">}</a> <a id="3328" class="Symbol">{{</a><a id="3330" href="ic15.html#3330" class="Bound">_</a> <a id="3332" class="Symbol">:</a> <a id="3334" href="Basics-v3.html#3944" class="Record">has[&lt;]</a> <a id="3341" href="ic15.html#3319" class="Bound">A</a><a id="3342" class="Symbol">}}</a> <a id="3345" class="Symbol">{{</a><a id="3347" href="ic15.html#3347" class="Bound">_</a> <a id="3349" class="Symbol">:</a> <a id="3351" href="Basics-v3.html#4162" class="Record">cor[&lt;]</a> <a id="3358" href="ic15.html#3319" class="Bound">A</a><a id="3359" class="Symbol">}}</a> <a id="3362" class="Symbol">{{</a><a id="3364" href="ic15.html#3364" class="Bound">_</a> <a id="3366" class="Symbol">:</a> <a id="3368" href="Basics-v3.html#5578" class="Record">has[&lt;?]</a> <a id="3376" href="ic15.html#3319" class="Bound">A</a><a id="3377" class="Symbol">}}</a> <a id="3380" class="Symbol">{{</a><a id="3382" href="ic15.html#3382" class="Bound">_</a> <a id="3384" class="Symbol">:</a> <a id="3386" href="Basics-v3.html#7407" class="Record">cor[&lt;?]</a> <a id="3394" href="ic15.html#3319" class="Bound">A</a><a id="3395" class="Symbol">}}</a> <a id="3398" class="Keyword">where</a>
  <a id="3406" class="Keyword">postulate</a>
    <a id="3420" href="ic15.html#3420" class="Postulate">split-perm</a> <a id="3431" class="Symbol">:</a> <a id="3433" class="Symbol">∀</a> <a id="3435" class="Symbol">(</a><a id="3436" href="ic15.html#3436" class="Bound">x</a> <a id="3438" href="ic15.html#3438" class="Bound">y</a> <a id="3440" class="Symbol">:</a> <a id="3442" href="ic15.html#3319" class="Bound">A</a><a id="3443" class="Symbol">)</a> <a id="3445" class="Symbol">(</a><a id="3446" href="ic15.html#3446" class="Bound">xs</a> <a id="3449" class="Symbol">:</a> <a id="3451" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="3456" href="ic15.html#3319" class="Bound">A</a><a id="3457" class="Symbol">)</a> <a id="3459" class="Symbol">→</a>
      <a id="3467" class="Keyword">let</a> <a id="3471" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="3473" href="ic15.html#3473" class="Bound">ys</a> <a id="3476" href="Basics-v3.html#1010" class="InductiveConstructor Operator">,</a> <a id="3478" href="ic15.html#3478" class="Bound">zs</a> <a id="3481" href="Basics-v3.html#1010" class="InductiveConstructor Operator">⟩</a> <a id="3483" class="Symbol">=</a> <a id="3485" href="ic15.html#2024" class="Function">split</a> <a id="3491" href="ic15.html#3436" class="Bound">x</a> <a id="3493" href="ic15.html#3438" class="Bound">y</a> <a id="3495" href="ic15.html#3446" class="Bound">xs</a>
      <a id="3504" class="Keyword">in</a> <a id="3507" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="3518" href="ic15.html#3473" class="Bound">ys</a> <a id="3521" href="Basics-v3.html#2303" class="Field Operator">+</a> <a id="3523" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="3534" href="ic15.html#3478" class="Bound">zs</a>
       <a id="3544" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="3546" href="Basics-v3.html#24332" class="Function Operator">b[</a> <a id="3549" href="ic15.html#3436" class="Bound">x</a> <a id="3551" href="Basics-v3.html#24332" class="Function Operator">]</a> <a id="3553" href="Basics-v3.html#2303" class="Field Operator">+</a> <a id="3555" href="Basics-v3.html#24332" class="Function Operator">b[</a> <a id="3558" href="ic15.html#3438" class="Bound">y</a> <a id="3560" href="Basics-v3.html#24332" class="Function Operator">]</a> <a id="3562" href="Basics-v3.html#2303" class="Field Operator">+</a> <a id="3564" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="3575" href="ic15.html#3446" class="Bound">xs</a>

    <a id="3583" href="ic15.html#3583" class="Postulate">merge-perm</a> <a id="3594" class="Symbol">:</a> <a id="3596" class="Symbol">∀</a> <a id="3598" class="Symbol">(</a><a id="3599" href="ic15.html#3599" class="Bound">xs</a> <a id="3602" href="ic15.html#3602" class="Bound">ys</a> <a id="3605" class="Symbol">:</a> <a id="3607" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="3612" href="ic15.html#3319" class="Bound">A</a><a id="3613" class="Symbol">)</a> <a id="3615" class="Symbol">→</a> <a id="3617" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="3628" class="Symbol">(</a><a id="3629" href="ic15.html#2624" class="Function">merge</a> <a id="3635" href="ic15.html#3599" class="Bound">xs</a> <a id="3638" href="ic15.html#3602" class="Bound">ys</a><a id="3640" class="Symbol">)</a> <a id="3642" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="3644" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="3655" href="ic15.html#3599" class="Bound">xs</a> <a id="3658" href="Basics-v3.html#2303" class="Field Operator">+</a> <a id="3660" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="3671" href="ic15.html#3602" class="Bound">ys</a>

    <a id="3679" href="ic15.html#3679" class="Postulate">msort′-perm</a> <a id="3691" class="Symbol">:</a> <a id="3693" class="Symbol">∀</a> <a id="3695" class="Symbol">(</a><a id="3696" href="ic15.html#3696" class="Bound">xs</a> <a id="3699" class="Symbol">:</a> <a id="3701" href="Basics-v3.html#17055" class="Datatype">list</a> <a id="3706" href="ic15.html#3319" class="Bound">A</a><a id="3707" class="Symbol">)</a> <a id="3709" class="Symbol">(</a><a id="3710" href="ic15.html#3710" class="Bound">a</a> <a id="3712" class="Symbol">:</a> <a id="3714" href="Basics-v3.html#25984" class="Datatype">acc</a> <a id="3718" href="Basics-v3.html#4016" class="Field Operator">_&lt;_</a> <a id="3722" class="Symbol">(</a><a id="3723" href="Basics-v3.html#18551" class="Function">length</a> <a id="3730" href="ic15.html#3696" class="Bound">xs</a><a id="3732" class="Symbol">))</a> <a id="3735" class="Symbol">→</a> <a id="3737" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="3748" class="Symbol">(</a><a id="3749" href="ic15.html#2802" class="Function">msort′</a> <a id="3756" href="ic15.html#3696" class="Bound">xs</a> <a id="3759" href="ic15.html#3710" class="Bound">a</a><a id="3760" class="Symbol">)</a> <a id="3762" href="Basics-v3.html#325" class="Datatype Operator">≡</a> <a id="3764" href="Basics-v3.html#25792" class="Function">list-elems</a> <a id="3775" href="ic15.html#3696" class="Bound">xs</a>
</pre></body></html>