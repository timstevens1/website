<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>la16</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="la16.html" class="Module">la16</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Basics-v4.html" class="Module">Basics-v4</a>

<a id="43" class="Keyword">data</a> <a id="color"></a><a id="48" href="la16.html#48" class="Datatype">color</a> <a id="54" class="Symbol">:</a> <a id="56" class="PrimitiveType">Set</a> <a id="60" class="Keyword">where</a>
  <a id="color.R"></a><a id="68" href="la16.html#68" class="InductiveConstructor">R</a> <a id="70" class="Symbol">:</a> <a id="72" href="la16.html#48" class="Datatype">color</a>
  <a id="color.B"></a><a id="80" href="la16.html#80" class="InductiveConstructor">B</a> <a id="82" class="Symbol">:</a> <a id="84" href="la16.html#48" class="Datatype">color</a>

<a id="91" class="Keyword">data</a> <a id="rbt"></a><a id="96" href="la16.html#96" class="Datatype">rbt</a> <a id="100" class="Symbol">:</a> <a id="102" class="PrimitiveType">Set</a> <a id="106" class="Keyword">where</a>
  <a id="rbt.Leaf"></a><a id="114" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="119" class="Symbol">:</a> <a id="121" href="la16.html#96" class="Datatype">rbt</a>
  <a id="rbt.[_/_/_]"></a><a id="127" href="la16.html#127" class="InductiveConstructor Operator">[_/_/_]</a> <a id="135" class="Symbol">:</a> <a id="137" href="la16.html#48" class="Datatype">color</a> <a id="143" class="Symbol">→</a> <a id="145" href="la16.html#96" class="Datatype">rbt</a> <a id="149" class="Symbol">→</a> <a id="151" href="la16.html#96" class="Datatype">rbt</a> <a id="155" class="Symbol">→</a> <a id="157" href="la16.html#96" class="Datatype">rbt</a>

<a id="t0"></a><a id="162" href="la16.html#162" class="Function">t0</a> <a id="165" class="Symbol">:</a> <a id="167" href="la16.html#96" class="Datatype">rbt</a>
<a id="171" href="la16.html#162" class="Function">t0</a> <a id="174" class="Symbol">=</a> <a id="176" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="178" href="la16.html#68" class="InductiveConstructor">R</a> <a id="180" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="182" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="187" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="189" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="194" href="la16.html#127" class="InductiveConstructor Operator">]</a>

<a id="197" class="Comment">-- the number of black nodes from every leaf to the root</a>
<a id="254" class="Keyword">data</a> <a id="black-nodes"></a><a id="259" href="la16.html#259" class="Datatype">black-nodes</a> <a id="271" class="Symbol">:</a> <a id="273" href="la16.html#96" class="Datatype">rbt</a> <a id="277" class="Symbol">→</a> <a id="279" href="Basics-v4.html#8956" class="Datatype">ℕ</a> <a id="281" class="Symbol">→</a> <a id="283" class="PrimitiveType">Set</a> <a id="287" class="Keyword">where</a>
  <a id="black-nodes.Leaf"></a><a id="295" href="la16.html#295" class="InductiveConstructor">Leaf</a> <a id="300" class="Symbol">:</a> <a id="302" href="la16.html#259" class="Datatype">black-nodes</a> <a id="314" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="319" class="Number">1</a>
  <a id="black-nodes.Node-R"></a><a id="323" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="330" class="Symbol">:</a> <a id="332" class="Symbol">∀</a> <a id="334" class="Symbol">{</a><a id="335" href="la16.html#335" class="Bound">n</a> <a id="337" href="la16.html#337" class="Bound">t₁</a> <a id="340" href="la16.html#340" class="Bound">t₂</a><a id="342" class="Symbol">}</a>
    <a id="348" class="Symbol">→</a> <a id="350" href="la16.html#259" class="Datatype">black-nodes</a> <a id="362" href="la16.html#337" class="Bound">t₁</a> <a id="365" href="la16.html#335" class="Bound">n</a>
    <a id="371" class="Symbol">→</a> <a id="373" href="la16.html#259" class="Datatype">black-nodes</a> <a id="385" href="la16.html#340" class="Bound">t₂</a> <a id="388" href="la16.html#335" class="Bound">n</a>
    <a id="394" class="Symbol">→</a> <a id="396" href="la16.html#259" class="Datatype">black-nodes</a> <a id="408" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="410" href="la16.html#68" class="InductiveConstructor">R</a> <a id="412" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="414" href="la16.html#337" class="Bound">t₁</a> <a id="417" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="419" href="la16.html#340" class="Bound">t₂</a> <a id="422" href="la16.html#127" class="InductiveConstructor Operator">]</a> <a id="424" href="la16.html#335" class="Bound">n</a>
  <a id="black-nodes.Node-B"></a><a id="428" href="la16.html#428" class="InductiveConstructor">Node-B</a> <a id="435" class="Symbol">:</a> <a id="437" class="Symbol">∀</a> <a id="439" class="Symbol">{</a><a id="440" href="la16.html#440" class="Bound">n</a> <a id="442" href="la16.html#442" class="Bound">t₁</a> <a id="445" href="la16.html#445" class="Bound">t₂</a><a id="447" class="Symbol">}</a>
    <a id="453" class="Symbol">→</a> <a id="455" href="la16.html#259" class="Datatype">black-nodes</a> <a id="467" href="la16.html#442" class="Bound">t₁</a> <a id="470" href="la16.html#440" class="Bound">n</a>
    <a id="476" class="Symbol">→</a> <a id="478" href="la16.html#259" class="Datatype">black-nodes</a> <a id="490" href="la16.html#445" class="Bound">t₂</a> <a id="493" href="la16.html#440" class="Bound">n</a>
    <a id="499" class="Symbol">→</a> <a id="501" href="la16.html#259" class="Datatype">black-nodes</a> <a id="513" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="515" href="la16.html#80" class="InductiveConstructor">B</a> <a id="517" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="519" href="la16.html#442" class="Bound">t₁</a> <a id="522" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="524" href="la16.html#445" class="Bound">t₂</a> <a id="527" href="la16.html#127" class="InductiveConstructor Operator">]</a> <a id="529" class="Symbol">(</a><a id="530" href="Basics-v4.html#8983" class="InductiveConstructor">Suc</a> <a id="534" href="la16.html#440" class="Bound">n</a><a id="535" class="Symbol">)</a>

<a id="538" class="Keyword">data</a> <a id="is-black"></a><a id="543" href="la16.html#543" class="Datatype">is-black</a> <a id="552" class="Symbol">:</a> <a id="554" href="la16.html#96" class="Datatype">rbt</a> <a id="558" class="Symbol">→</a> <a id="560" class="PrimitiveType">Set</a> <a id="564" class="Keyword">where</a>
  <a id="is-black.Leaf"></a><a id="572" href="la16.html#572" class="InductiveConstructor">Leaf</a> <a id="577" class="Symbol">:</a> <a id="579" href="la16.html#543" class="Datatype">is-black</a> <a id="588" href="la16.html#114" class="InductiveConstructor">Leaf</a>
  <a id="is-black.Node"></a><a id="595" href="la16.html#595" class="InductiveConstructor">Node</a> <a id="600" class="Symbol">:</a> <a id="602" class="Symbol">∀</a> <a id="604" class="Symbol">{</a><a id="605" href="la16.html#605" class="Bound">t₁</a> <a id="608" href="la16.html#608" class="Bound">t₂</a><a id="610" class="Symbol">}</a>
    <a id="616" class="Symbol">→</a> <a id="618" href="la16.html#543" class="Datatype">is-black</a> <a id="627" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="629" href="la16.html#80" class="InductiveConstructor">B</a> <a id="631" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="633" href="la16.html#605" class="Bound">t₁</a> <a id="636" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="638" href="la16.html#608" class="Bound">t₂</a> <a id="641" href="la16.html#127" class="InductiveConstructor Operator">]</a>

<a id="644" class="Comment">-- every red node has black (not red) children</a>
<a id="691" class="Keyword">data</a> <a id="red-children"></a><a id="696" href="la16.html#696" class="Datatype">red-children</a> <a id="709" class="Symbol">:</a> <a id="711" href="la16.html#96" class="Datatype">rbt</a> <a id="715" class="Symbol">→</a> <a id="717" class="PrimitiveType">Set</a> <a id="721" class="Keyword">where</a>
  <a id="red-children.Leaf"></a><a id="729" href="la16.html#729" class="InductiveConstructor">Leaf</a> <a id="734" class="Symbol">:</a> <a id="736" href="la16.html#696" class="Datatype">red-children</a> <a id="749" href="la16.html#114" class="InductiveConstructor">Leaf</a>
  <a id="red-children.Node-R"></a><a id="756" href="la16.html#756" class="InductiveConstructor">Node-R</a> <a id="763" class="Symbol">:</a> <a id="765" class="Symbol">∀</a> <a id="767" class="Symbol">{</a><a id="768" href="la16.html#768" class="Bound">t₁</a> <a id="771" href="la16.html#771" class="Bound">t₂</a><a id="773" class="Symbol">}</a>
    <a id="779" class="Symbol">→</a> <a id="781" href="la16.html#543" class="Datatype">is-black</a> <a id="790" href="la16.html#768" class="Bound">t₁</a>
    <a id="797" class="Symbol">→</a> <a id="799" href="la16.html#543" class="Datatype">is-black</a> <a id="808" href="la16.html#771" class="Bound">t₂</a>
    <a id="815" class="Symbol">→</a> <a id="817" href="la16.html#696" class="Datatype">red-children</a> <a id="830" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="832" href="la16.html#68" class="InductiveConstructor">R</a> <a id="834" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="836" href="la16.html#768" class="Bound">t₁</a> <a id="839" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="841" href="la16.html#771" class="Bound">t₂</a> <a id="844" href="la16.html#127" class="InductiveConstructor Operator">]</a>
  <a id="red-children.Node-B"></a><a id="848" href="la16.html#848" class="InductiveConstructor">Node-B</a> <a id="855" class="Symbol">:</a> <a id="857" class="Symbol">∀</a> <a id="859" class="Symbol">{</a><a id="860" href="la16.html#860" class="Bound">t₁</a> <a id="863" href="la16.html#863" class="Bound">t₂</a><a id="865" class="Symbol">}</a>
    <a id="871" class="Symbol">→</a> <a id="873" href="la16.html#696" class="Datatype">red-children</a> <a id="886" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="888" href="la16.html#80" class="InductiveConstructor">B</a> <a id="890" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="892" href="la16.html#860" class="Bound">t₁</a> <a id="895" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="897" href="la16.html#863" class="Bound">t₂</a> <a id="900" href="la16.html#127" class="InductiveConstructor Operator">]</a>
  

<a id="t1"></a><a id="906" href="la16.html#906" class="Function">t1</a> <a id="909" class="Symbol">:</a> <a id="911" href="la16.html#96" class="Datatype">rbt</a>
<a id="915" href="la16.html#906" class="Function">t1</a> <a id="918" class="Symbol">=</a> <a id="920" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="922" href="la16.html#68" class="InductiveConstructor">R</a> <a id="924" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="926" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="928" href="la16.html#80" class="InductiveConstructor">B</a> <a id="930" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="932" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="937" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="939" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="944" href="la16.html#127" class="InductiveConstructor Operator">]</a>
            <a id="958" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="960" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="962" href="la16.html#80" class="InductiveConstructor">B</a> <a id="964" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="966" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="968" href="la16.html#68" class="InductiveConstructor">R</a> <a id="970" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="972" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="977" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="979" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="984" href="la16.html#127" class="InductiveConstructor Operator">]</a>
                     <a id="1007" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="1009" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="1014" href="la16.html#127" class="InductiveConstructor Operator">]</a> <a id="1016" href="la16.html#127" class="InductiveConstructor Operator">]</a>

<a id="1019" href="la16.html#1019" class="Function">_</a> <a id="1021" class="Symbol">:</a> <a id="1023" href="la16.html#259" class="Datatype">black-nodes</a> <a id="1035" href="la16.html#906" class="Function">t1</a> <a id="1038" class="Number">2</a>
<a id="1040" class="Symbol">_</a> <a id="1042" class="Symbol">=</a> <a id="1044" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="1051" class="Symbol">(</a><a id="1052" href="la16.html#428" class="InductiveConstructor">Node-B</a> <a id="1059" href="la16.html#295" class="InductiveConstructor">Leaf</a> <a id="1064" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1068" class="Symbol">)</a> <a id="1070" class="Symbol">(</a><a id="1071" href="la16.html#428" class="InductiveConstructor">Node-B</a> <a id="1078" class="Symbol">(</a><a id="1079" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="1086" href="la16.html#295" class="InductiveConstructor">Leaf</a> <a id="1091" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1095" class="Symbol">)</a> <a id="1097" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1101" class="Symbol">)</a>

<a id="1104" href="la16.html#1104" class="Function">_</a> <a id="1106" class="Symbol">:</a> <a id="1108" href="la16.html#696" class="Datatype">red-children</a> <a id="1121" href="la16.html#906" class="Function">t1</a>
<a id="1124" class="Symbol">_</a> <a id="1126" class="Symbol">=</a> <a id="1128" href="la16.html#756" class="InductiveConstructor">Node-R</a> <a id="1135" href="la16.html#595" class="InductiveConstructor">Node</a> <a id="1140" href="la16.html#595" class="InductiveConstructor">Node</a>

<a id="1146" href="la16.html#1146" class="Function">_</a> <a id="1148" class="Symbol">:</a> <a id="1150" href="la16.html#259" class="Datatype">black-nodes</a> <a id="1162" href="la16.html#906" class="Function">t1</a> <a id="1165" class="Number">2</a> <a id="1167" href="Basics-v4.html#968" class="Record Operator">∧</a> <a id="1169" href="la16.html#696" class="Datatype">red-children</a> <a id="1182" href="la16.html#906" class="Function">t1</a>
<a id="1185" class="Symbol">_</a> <a id="1187" class="Symbol">=</a> <a id="1189" href="Basics-v4.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1191" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="1198" class="Symbol">(</a><a id="1199" href="la16.html#428" class="InductiveConstructor">Node-B</a> <a id="1206" href="la16.html#295" class="InductiveConstructor">Leaf</a> <a id="1211" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1215" class="Symbol">)</a> <a id="1217" class="Symbol">(</a><a id="1218" href="la16.html#428" class="InductiveConstructor">Node-B</a> <a id="1225" class="Symbol">(</a><a id="1226" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="1233" href="la16.html#295" class="InductiveConstructor">Leaf</a> <a id="1238" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1242" class="Symbol">)</a> <a id="1244" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1248" class="Symbol">)</a> <a id="1250" href="Basics-v4.html#1010" class="InductiveConstructor Operator">,</a>
      <a id="1258" href="la16.html#756" class="InductiveConstructor">Node-R</a> <a id="1265" href="la16.html#595" class="InductiveConstructor">Node</a> <a id="1270" href="la16.html#595" class="InductiveConstructor">Node</a> <a id="1275" href="Basics-v4.html#1010" class="InductiveConstructor Operator">⟩</a>

<a id="t2"></a><a id="1278" href="la16.html#1278" class="Function">t2</a> <a id="1281" class="Symbol">:</a> <a id="1283" href="la16.html#96" class="Datatype">rbt</a>
<a id="1287" href="la16.html#1278" class="Function">t2</a> <a id="1290" class="Symbol">=</a> <a id="1292" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="1294" href="la16.html#80" class="InductiveConstructor">B</a> <a id="1296" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="1298" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="1300" href="la16.html#68" class="InductiveConstructor">R</a> <a id="1302" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="1304" href="la16.html#127" class="InductiveConstructor Operator">[</a> <a id="1306" href="la16.html#68" class="InductiveConstructor">R</a> <a id="1308" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="1310" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="1315" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="1317" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="1322" href="la16.html#127" class="InductiveConstructor Operator">]</a>
                     <a id="1345" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="1347" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="1352" href="la16.html#127" class="InductiveConstructor Operator">]</a>
            <a id="1366" href="la16.html#127" class="InductiveConstructor Operator">/</a> <a id="1368" href="la16.html#114" class="InductiveConstructor">Leaf</a> <a id="1373" href="la16.html#127" class="InductiveConstructor Operator">]</a>

<a id="1376" href="la16.html#1376" class="Function">_</a> <a id="1378" class="Symbol">:</a> <a id="1380" href="la16.html#259" class="Datatype">black-nodes</a> <a id="1392" href="la16.html#1278" class="Function">t2</a> <a id="1395" class="Number">2</a>
<a id="1397" class="Symbol">_</a> <a id="1399" class="Symbol">=</a> <a id="1401" href="la16.html#428" class="InductiveConstructor">Node-B</a> <a id="1408" class="Symbol">(</a><a id="1409" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="1416" class="Symbol">(</a><a id="1417" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="1424" href="la16.html#295" class="InductiveConstructor">Leaf</a> <a id="1429" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1433" class="Symbol">)</a> <a id="1435" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1439" class="Symbol">)</a> <a id="1441" href="la16.html#295" class="InductiveConstructor">Leaf</a>

<a id="1447" href="la16.html#1447" class="Function">_</a> <a id="1449" class="Symbol">:</a> <a id="1451" href="la16.html#696" class="Datatype">red-children</a> <a id="1464" href="la16.html#1278" class="Function">t2</a>
<a id="1467" class="Symbol">_</a> <a id="1469" class="Symbol">=</a> <a id="1471" href="la16.html#848" class="InductiveConstructor">Node-B</a>

<a id="1479" href="la16.html#1479" class="Function">_</a> <a id="1481" class="Symbol">:</a> <a id="1483" href="la16.html#259" class="Datatype">black-nodes</a> <a id="1495" href="la16.html#1278" class="Function">t2</a> <a id="1498" class="Number">2</a> <a id="1500" href="Basics-v4.html#968" class="Record Operator">∧</a> <a id="1502" href="la16.html#696" class="Datatype">red-children</a> <a id="1515" href="la16.html#1278" class="Function">t2</a>
<a id="1518" class="Symbol">_</a> <a id="1520" class="Symbol">=</a> <a id="1522" href="Basics-v4.html#1010" class="InductiveConstructor Operator">⟨</a> <a id="1524" href="la16.html#428" class="InductiveConstructor">Node-B</a> <a id="1531" class="Symbol">(</a><a id="1532" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="1539" class="Symbol">(</a><a id="1540" href="la16.html#323" class="InductiveConstructor">Node-R</a> <a id="1547" href="la16.html#295" class="InductiveConstructor">Leaf</a> <a id="1552" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1556" class="Symbol">)</a> <a id="1558" href="la16.html#295" class="InductiveConstructor">Leaf</a><a id="1562" class="Symbol">)</a> <a id="1564" href="la16.html#295" class="InductiveConstructor">Leaf</a> <a id="1569" href="Basics-v4.html#1010" class="InductiveConstructor Operator">,</a> <a id="1571" href="la16.html#848" class="InductiveConstructor">Node-B</a> <a id="1578" href="Basics-v4.html#1010" class="InductiveConstructor Operator">⟩</a>
</pre></body></html>